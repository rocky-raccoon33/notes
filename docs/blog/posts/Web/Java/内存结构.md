
![](./img/struct.png)

## `1` 内存分配策略



## `2` 常见问题

> OOM 排查

1. 查看堆栈信息：当程序发生 OOM 时，首先需要查看堆栈信息，定位哪个类或方法占用了大量内存。

2. 检查内存泄漏：使用工具检查内存泄漏，例如使用 `VisualVM`，定位内存泄漏点。

3. 分析内存使用情况：使用工具分析内存使用情况，例如使用 `VisualVM` 或 `jstat`，查看内存使用情况、GC 次数等信息，确定内存使用情况是否合理。

4. 增加堆内存：如果程序需要更多的内存，可以通过设置 JVM 参数增加堆内存大小，例如 -Xmx。

5. 优化代码：如果程序中存在大量无用对象或重复创建对象的情况，可以优化代码，减少内存占用。

___

> 频繁 FGC 排查

1. 内存泄漏
2. 大对象
3. System.gc()

常规做法：`jmap` 导出堆内存快照 `jmap -dump:format=b，file=filename [pid]` ，然后用 `visualVM` 等工具分析出什么对象占用了大量空间，再查看相关引用找到问题代码 `-XX:+HeapDumpBeforeFullGC`


